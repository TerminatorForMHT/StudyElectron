<!DOCTYPE HTML>
<html>

<head>

	<title>New Post &mdash; Write.as</title>

	<link rel="stylesheet" type="text/css" href="../UI/CSS/net_css_write.css" />
	<link rel="shortcut icon" href="../img/favicon.ico" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<meta name="apple-mobile-web-app-title" content="Write.as">
	<link rel="apple-touch-icon" sizes="152x152" href="https://cdn.writeas.net/img/touch-icon-152.png">
	<link rel="apple-touch-icon" sizes="167x167" href="https://cdn.writeas.net/img/touch-icon-167.png">
	<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.writeas.net/img/touch-icon-180.png">
	<meta name="google" value="notranslate">

	<meta name="description"
		content="Start writing a thought, essay, or blog post without the blog. Publish instantly.">
	<meta name="application-url" content="https://write.as/new">
	<meta itemprop="name" content="New Post">
	<meta itemprop="description"
		content="Start writing a thought, essay, or blog post without the blog. Publish instantly.">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@writeas__">
	<meta name="twitter:image" content="https://cdn.writeas.net/img/writeas_dark.png">
	<meta name="twitter:title" content="New Post">
	<meta name="twitter:description"
		content="Start writing a thought, essay, or blog post without the blog. Publish instantly.">
	<meta name="twitter:app:name:googleplay" content="Write.as">
	<meta name="twitter:app:id:googleplay" content="com.abunchtell.writeas">
	<meta name="twitter:app:name:iphone" content="Write.as">
	<meta name="twitter:app:id:iphone" content="1000755153">
	<meta name="twitter:app:name:ipad" content="Write.as">
	<meta name="twitter:app:id:ipad" content="1000755153">
	<meta property="og:title" content="New Post" />
	<meta property="og:image" content="https://write.as/img/writeas_dark.png" />
	<meta property="og:site_name" content="Write.as" />
	<meta property="og:type" content="object" />
	<meta property="og:description"
		content="Start writing a thought, essay, or blog post without the blog. Publish instantly." />
	<meta property="al:android:app_name" content="Write.as">
	<meta property="al:android:package" content="com.abunchtell.writeas">
	<meta property="al:ios:app_store_id" content="1000755153" />
	<meta property="al:ios:app_name" content="Write.as" />

	<style>
		#dash-icon {
			width: 28px;
			height: 28px;
			vertical-align: top;
		}
	</style>
</head>

<body id="pad" class="light">

	<div id="overlay"></div>

	<textarea id="writer" placeholder="Write..." class="norm" autofocus></textarea>

	<div class="alert success hidden" id="edited-elsewhere">This post has been updated elsewhere since you last
		published! <a href="#" id="erase-edit">Delete draft and reload</a>.</div>

	<header id="tools">
		<div id="clip">
			<nav class="dropdown-nav shiny" style="margin:0">
				<ul>
					<li class="has-submenu">
						<h1 style="font-size:1.6em; line-height: 0.5"><a href="#"
								onclick="_paq.push(['trackEvent', 'Navigation', 'view blogs', 'pad: top left']);return false;"><img
									id="dash-icon" class="ic-24dp" alt="Write.as - home"
									src="https://cdn.writeas.net/img/w-sq.svg"
									style="width:28px;height:28px;vertical-align:middle" /> <img class="ic-18dp"
									style="margin-bottom: -3px;"
									src="https://cdn.writeas.net/img/ic_down_arrow_dark@2x.png" /></a>
						</h1>
						<ul>

							<li><a href="/"
									onclick="_paq.push(['trackEvent', 'Navigation', 'home', 'pad: dropdown']);">Home</a>
							</li>
							<li><a href="/about"
									onclick="_paq.push(['trackEvent', 'Navigation', 'about', 'pad: dropdown']);">About</a>
							</li>
							<li><a href="/pricing"
									onclick="_paq.push(['trackEvent', 'Navigation', 'pricing', 'pad: dropdown']);">Pricing</a>
							</li>
							<li><a href="https://read.write.as"
									onclick="_paq.push(['trackEvent', 'Navigation', 'Read Write.as', 'pad: dropdown']);">Read</a>
							</li>
							<li id="user-separator" class="separator">
								<hr />
							</li>
							<li><a id="new-blog" href="/start"><i class="material-icons md-18">playlist_add</i> Sign
									Up</a></li>
							<li><a id="existing-blog" href="#existing-blog"><i class="material-icons md-18">person</i>
									Log In</a></li>

						</ul>
					</li>
				</ul>
			</nav>
			<nav id="target" class="shiny">
				<ul>
					<li class="has-submenu"><a href="#" id="publish-to" onclick="return false"><span
								id="target-name">Anonymous</span> <img class="ic-18dp"
								src="https://cdn.writeas.net/img/ic_down_arrow_dark@2x.png" /></a>
						<ul>
							<li class="menu-heading">Publish to...</li>

							<li class="target selected" id="anonymous"><a href="#anonymous"><i
										class="material-icons md-18">description</i> Anonymous</a></li>
							<li class="checkable rwa"><a title="read.write.as" href="#rwa"><input type="checkbox"
										style="float:right" /><img class="icon"
										src="https://cdn.writeas.net/img/read_icon.png" /> <span>Read
										Write.as</span></a></li>

						</ul>
					</li>
				</ul>
			</nav>
			<nav id="font-picker" class="if-room room-3 hidden shiny" style="margin-left:-1em">
				<ul>
					<li class="has-submenu"><a href="#" id="" onclick="return false"><img class="ic-24dp"
								src="https://cdn.writeas.net/img/ic_font_dark@2x.png" /> <img class="ic-18dp"
								src="https://cdn.writeas.net/img/ic_down_arrow_dark@2x.png" /></a>
						<ul>
							<li class="menu-heading">Font</li>
							<li class="selected"><a class="font norm" href="#norm">Serif</a></li>
							<li><a class="font sans" href="#sans">Sans-serif</a></li>
							<li><a class="font wrap" href="#wrap">Monospace</a></li>
						</ul>
					</li>
				</ul>
			</nav>
			<span id="wc" class="hidden if-room room-4">0 words</span>
		</div>
		<noscript style="margin-left: 2em;"><strong>NOTE</strong>: for now, you'll need Javascript enabled to
			post.</noscript>
		<div id="belt">

			<div class="tool hidden if-room room-2"><a href="#theme" title="Toggle theme" id="toggle-theme"><img
						class="ic-24dp" src="https://cdn.writeas.net/img/ic_brightness_dark@2x.png" /></a></div>
			<div class="tool if-room room-1"><a href="/pad/posts" title="View posts" id="view-posts"
					onclick="_paq.push(['trackEvent', 'Navigation', 'view posts', 'pad: top right']);"><img
						class="ic-24dp" src="https://cdn.writeas.net/img/ic_list_dark@2x.png" /></a></div>
			<div class="tool"><button title="Publish" id="publish" style="font-weight: bold">Publish</button></div>
		</div>
	</header>

	<div id="modal-rwa" class="modal">
		<p class="intro" style="margin-top:0.5em">Reach an audience, anonymously.</p>
		<div class="body">
			<p style="text-align:center">Want to share a thought without your name on it? You can publish to our
				community on <a href="https://read.write.as/">Read Write.as</a> anonymously!</p>

			<p>As a free user, all posts go through our moderation process, where we check that they abide by our <a
					href="https://read.write.as/community">community guidelines</a> before publishing.</p>
			<p>If you'd like to permanently join Read Write.as and skip the moderation queue, you can <a
					href="/start/pro"
					onclick="_paq.push(['trackEvent', 'Subscription', 'prompt', 'rwa instant publish']);">upgrade to
					Pro</a> for as little as $5 per month.</p>

		</div>
	</div>

	<div id="modal-editor-upgrade" class="modal">
		<h2>Rich editing and easy uploading</h2>
		<div class="body short">
			<p style="text-align: left">Our <strong>Classic Editor</strong> makes writing posts and uploading photos
				simple &mdash; no Markdown knowledge required. Get it by upgrading to <a href="/pro"
					style="font-weight: bold;">Write.as Pro</a>.</p>
			<p style="margin: 1.5em 0;"><img id="classic-demo" src="" style="max-width: 100%" /></p>
			<p><a class="btn cta" href="/upgrade/pro/pay?to=/">Start free 14-day Pro trial</a></p>
			<p class="btn-desc" style="margin-top: 0.5em !important;">Then subscribe monthly, yearly, or every <a
					href="/5years">five years</a>.</p>
		</div>
	</div>



	<div id="modal-new-blog" class="modal">
		<h2>New Blog</h2>
		<div class="body short">
			<form action="#" method="post" id="form-create-blog">
				<p><label>write.as / <input type="text" name="title" /></label></p>
				<ul id="new-blog-errors" class="errors"></ul>
				<div id="new-blog-url-cont">
					<p>You'll use this to log in to Write.as and sync posts across your devices.</p>
				</div>
				<input type="submit" id="btn-create-blog" value="Create" />
			</form>
		</div>
	</div>

	<div id="modal-login" class="modal">
		<form action="#" method="post" id="form-login">
			<h2>Publish to Existing Blog</h2>
			<p>Log in to your existing Write.as account.</p>
			<ul id="login-errors" class="errors"></ul>
			<div class="body short">
				<p><label>Username<br /><input class="underline" type="text" name="username" /></label></p>
				<p><label>Password<br /><input class="underline" type="password" name="password" /></label></p>
				<p id="email-login-hint" class="form-hint">Leave blank to log in via email.</p>
				<input type="submit" id="btn-login" value="Log in" />
			</div>
		</form>
	</div>


	<script src="https://cdn.writeas.net/js/h.6913452.js"></script>
	<script type="text/javascript" src="https://cdn.writeas.net/js/menu.94518a2.js"></script>
	<script>
		let loadDate = new Date().getTime();
		function toggleTheme() {
			var btns = Array.prototype.slice.call(document.getElementById('tools').querySelectorAll('a img'));
			var dashIcon = document.getElementById('dash-icon');
			var newTheme = '';
			if (document.body.classList.contains('light')) {
				newTheme = 'dark';
				document.body.className = document.body.className.replace(/(?:^|\s)light(?!\S)/g, newTheme);
				try {
					dashIcon.src = dashIcon.src.replace('.svg', '-light.svg');
				} catch (e) { }
				for (var i = 0; i < btns.length; i++) {
					btns[i].src = btns[i].src.replace('_dark@2x.png', '@2x.png');
				}
			} else {
				newTheme = 'light';
				document.body.className = document.body.className.replace(/(?:^|\s)dark(?!\S)/g, newTheme);
				try {
					dashIcon.src = dashIcon.src.replace('-light.svg', '.svg');
				} catch (e) { }
				for (var i = 0; i < btns.length; i++) {
					btns[i].src = btns[i].src.replace('@2x.png', '_dark@2x.png');
				}
			}
			H.set('padTheme', newTheme);
		}
		if (H.get('padTheme', 'light') != 'light') {
			toggleTheme();
		}
		var $writer = H.getEl('writer');
		var $btnPublish = H.getEl('publish');
		var $btnEraseEdit = H.getEl('edited-elsewhere');
		var $wc = H.getEl("wc");
		var updateWordCount = function () {
			var words = 0;
			var val = $writer.el.value.trim();
			if (val != '') {
				words = $writer.el.value.trim().replace(/\s+/gi, ' ').split(' ').length;
			}
			$wc.el.innerText = words + " word" + (words != 1 ? "s" : "");
		};
		var setButtonStates = function () {
			if (!canPublish) {
				$btnPublish.el.className = 'disabled';
				return;
			}
			if ($writer.el.value.length === 0 || (draftDoc != 'lastDoc' && $writer.el.value == origDoc)) {
				$btnPublish.el.disabled = true;
				$btnPublish.el.className = 'disabled';
			} else {
				$btnPublish.el.disabled = false;
				$btnPublish.el.className = '';
			}
		};
		var draftDoc = 'lastDoc';
		var updatedStr = '';
		var updated = null;
		if (updatedStr != '') {
			updated = new Date(updatedStr);
		}
		var ok = H.load($writer, draftDoc, true, updated);
		if (!ok) {

			$btnEraseEdit.el.classList.remove('hidden');
		}
		var defaultTimeSet = false;
		updateWordCount();

		var typingTimer;
		var doneTypingInterval = 200;

		var posts;
		var canPublish = true;
		var publishing = false;
		var justPublished = false;
		var isPublic = false;

		var signup = function (user, callback) {

			document.getElementById('new-blog-errors').innerHTML = '';

			if (user == "") {
				document.getElementById('new-blog-errors').innerHTML = '<li class="urgent">Please pick a username.</li>';
				if (callback != null) {
					callback();
				}
				return;
			}

			var http = new XMLHttpRequest();
			var url = "/api/auth/signup";
			var params = {
				alias: user,
				web: true,
				pad: true,
				normalize: true
			};
			http.open("POST", url, true);
			http.setRequestHeader("Content-type", "application/json");

			http.onreadystatechange = function () {
				if (http.readyState == 4) {
					if (callback != null) {
						callback();
					}
					data = JSON.parse(http.responseText);
					if (http.status == 201) {
						try { _paq.push(['trackEvent', 'User', 'sign up']); } catch (e) { }
						document.querySelector('input[name=title]').value = data.data.user.username;
						window.location = document.URL + '#' + data.data.user.username;
						location.reload();
					} else {
						document.getElementById('new-blog-errors').innerHTML = '<li class="urgent">' + data.error_msg + '</li>';
					}
				}
			};
			http.send(JSON.stringify(params));
		};

		var login = function (user, pass, callback) {

			document.getElementById('login-errors').innerHTML = '';
			document.querySelector('input[name=username]').disabled = true;
			document.querySelector('input[name=password]').disabled = true;

			var http = new XMLHttpRequest();
			var url = "/api/auth/login";
			var params = {
				alias: user,
				pass: pass,
				web: true
			};
			if (pass == "") {
				params.via_email = true;
			}
			http.open("POST", url, true);
			http.setRequestHeader("Content-type", "application/json");

			http.onreadystatechange = function () {
				if (http.readyState == 4) {
					if (http.status != 200) {
						document.querySelector('input[name=username]').disabled = false;
						document.querySelector('input[name=password]').disabled = false;
					}
					if (callback != null) {
						if (http.status != 200 && http.status != 202) {
							callback();
						}
					}
					data = JSON.parse(http.responseText);
					if (http.status == 200 || http.status == 202) {
						try { _paq.push(['trackEvent', 'User', 'log in', (params.via_email === true ? 'email' : 'password')]); } catch (e) { }
						if (typeof data.data.msg !== 'undefined' && data.data.msg !== "") {
							document.getElementById('login-errors').innerHTML = '<li class="info">' + data.data.msg + '</li>';
							if (http.status == 202) {
								document.querySelector('#modal-login > .body').style.display = 'none';
							}
						} else {
							var uname = data.data.user.username;
							document.querySelector('input[name=username]').value = uname;
							document.getElementById('login-errors').innerHTML = '<li class="info">Welcome back, <strong>' + uname + '</strong>! Loading account...</li>';
							window.location = document.URL;
						}
					} else {
						var $errors = document.getElementById('login-errors');
						var errMsg = data.error_msg.replace(/username is actually ([a-z\-]+)\./, 'username is actually <strong>$1</strong>.');
						var incFuzzyUsername = errMsg != data.error_msg;
						if (incFuzzyUsername) {
							fuzzyUsernameCount++;
						}
						errMsg = errMsg.replace(/contact us/, '<a href="/contact">contact us</a>');
						$errors.innerHTML = '<li class="urgent">' + errMsg + '</li>';
						if (incFuzzyUsername && fuzzyUsernameCount >= 2) {
							document.querySelector('input[name=username]').value = $errors.querySelector('li.urgent > strong').innerText;
						}
						if (http.status == 412) {

							document.getElementById('email-login-hint').style.display = 'none';
							document.querySelector('input[name=password]').focus();
						}
					}
				}
			};
			http.send(JSON.stringify(params));
		};

		var fuzzyUsernameCount = 0;
		let postTargetKey = 'postTarget';
		var silenced = false;
		var unconfirmed = false;
		var nonmember = false;
		var uptoc = false;
		var publish = function (content, font) {
			if (unconfirmed === true) {
				alert("Please confirm your email address before publishing.");
				return;
			} else if (nonmember === true) {
				showModal('membership');
				return;
			} else if (uptoc === true) {
				showModal('upgrade-to-continue');
				return;
			} else if (silenced === true) {
				alert("Your account is silenced, so you can't publish or update posts.");
				return;
			}

			$btnPublish.el.textContent = 'Publishing...';
			publishing = true;
			var xpostTarg = H.get('crosspostTarget', '[]');

			var http = new XMLHttpRequest();
			var post = H.getTitleStrict(content);

			var params = {
				body: post.content,
				title: post.title,
				font: font,
				web: true,
				top: new Date().getTime() - loadDate
			};


			var lang = navigator.languages ? navigator.languages[0] : (navigator.language || navigator.userLanguage);
			lang = lang.substring(0, 2);
			params.lang = lang;

			var url = "/api/posts";
			var postTarget = H.get(postTargetKey, 'anonymous');
			if (postTarget != 'anonymous') {
				url = "/api/collections/" + postTarget + "/posts";
			}
			params.crosspost = JSON.parse(xpostTarg);
			params.public = isPublic;


			http.open("POST", url, true);


			http.setRequestHeader("Content-type", "application/json");

			http.onreadystatechange = function () {
				if (http.readyState == 4) {
					publishing = false;
					if (http.status == 200 || http.status == 201) {
						data = JSON.parse(http.responseText);
						id = data.data.id;
						var nextID = id;
						var pre = '';
						if (data.data.type == "prompt") {
							pre = 'p/';
						} else if (data.data.type == "submission-draft" && data.data.parent_id != '') {
							pre = 's/';
							nextID = data.data.parent_id;
						}
						nextURL = '/' + pre + nextID + (nextID != 'spamspamspamspam' && nextID != 'contentisblocked' && pre == '' ? '.md' : '');
						localStorage.setItem('draft' + id + '-published', new Date().toISOString());



						if (postTarget != 'anonymous' && id != 'spamspamspamspam' && id != 'contentisblocked') {
							nextURL = '/' + postTarget + '/' + data.data.slug;
						}
						editToken = data.data.token;

						if (postTarget == 'anonymous') {

							var posts = JSON.parse(H.get('posts', '[]'));

							posts.push(H.createPost(id, editToken, content));

							H.set('posts', JSON.stringify(posts));
							if (id != 'spamspamspamspam' && id != 'contentisblocked') { try { _paq.push(['trackEvent', 'Post', 'publish', 'anonymous']); } catch (e) { } }
						}


						justPublished = true;
						if (draftDoc != 'lastDoc') {
							H.remove(draftDoc);

						} else if (id != 'spamspamspamspam' && id != 'contentisblocked') {
							H.set(draftDoc, '');
						}


						setCookie('newpost', '1', 30)

						window.location = nextURL;

					} else if (http.status == 401) {
						$btnPublish.el.textContent = 'Publish';
						alert("You don't have permission to publish here.");
					} else if (http.status == 402 || http.status == 403) {
						$btnPublish.el.textContent = 'Publish';
						data = JSON.parse(http.responseText);
						if (data.error_msg.includes("IP address")) {
							alert("Your IP address (103.149.249.137) is banned for abusive activity. If this is in error, please contact us! help@write.as");
						} else {
							alert(data.error_msg);
						}
					} else if (http.status == 429) {
						$btnPublish.el.textContent = 'Publish';
						alert("You're publishing too often. Please wait a bit before trying again.");
					} else if (http.status == 503) {
						$btnPublish.el.textContent = 'Publish';
						alert("Our servers are overloaded right now... 😞 Please try again in a minute or two.");
					} else {
						$btnPublish.el.textContent = 'Publish';
						alert("Failed to post. Please try again. (" + http.status + ")");
					}
				}
			}
			http.send(JSON.stringify(params));
		};

		function setCookie(name, value, seconds) {
			var expires = "";
			if (seconds) {
				var date = new Date();
				date.setTime(date.getTime() + (seconds * 1000));
				expires = "; expires=" + date.toUTCString();
			}
			document.cookie = name + "=" + (value || "") + expires + "; path=/";
		}

		setButtonStates();
		$writer.on('keyup input', function () {
			setButtonStates();
			clearTimeout(typingTimer);
			typingTimer = setTimeout(doneTyping, doneTypingInterval);
		}, false);
		$writer.on('keydown', function (e) {
			clearTimeout(typingTimer);
			if (e.keyCode == 13 && (e.metaKey || e.ctrlKey)) {
				$btnPublish.el.click();
			}
		});
		$btnPublish.on('click', function (e) {
			e.preventDefault();
			if (!publishing && $writer.el.value) {
				var content = $writer.el.value;
				publish(content, selectedFont);
			}
		});
		H.getEl('erase-edit').on('click', function (e) {
			e.preventDefault();
			H.remove(draftDoc);
			H.remove(draftDoc + '-published');
			justPublished = true;
			location.reload();
		});

		function showModal(id) {
			document.getElementById('overlay').style.display = 'block';
			document.getElementById('modal-' + id).style.display = 'block';
		}

		var $btnCreateBlog = H.getEl('btn-create-blog').el;
		H.getEl('form-create-blog').on('submit', function (e) {
			e.preventDefault();
			$btnCreateBlog.disabled = true;
			var origVal = $btnCreateBlog.value;
			$btnCreateBlog.value = "Creating...";
			document.getElementById('new-blog-errors').innerHTML = '';
			signup(document.querySelector('input[name=title]').value, function () {
				$btnCreateBlog.disabled = false;
				$btnCreateBlog.value = origVal;
			});
		});

		H.getEl('overlay').on('click', function (e) {
			e.preventDefault();
			document.getElementById('overlay').style.display = 'none';
			var modals = document.querySelectorAll('.modal');
			for (var i = 0; i < modals.length; i++) {
				modals[i].style.display = 'none';
			}
		});

		H.getEl('toggle-theme').on('click', function (e) {
			e.preventDefault();
			try {
				var newTheme = 'light';
				if (document.body.className == 'light') {
					newTheme = 'dark';
				}
				_paq.push(['trackEvent', 'Pad', 'toggle theme', newTheme]);
			} catch (e) { }
			toggleTheme();
		});







		var $btnLogin = H.getEl('btn-login').el;
		H.getEl('form-login').on('submit', function (e) {
			e.preventDefault();
			$btnLogin.disabled = true;
			login(document.querySelector('input[name=username]').value, document.querySelector('input[name=password]').value, function () {
				$btnLogin.disabled = false;
			});
		});
		H.getEl('existing-blog').on('click', function (e) {
			e.preventDefault();

			showModal('login');
			document.getElementById('modal-login').querySelector('input[name=username]').focus();
		});


		var $rwaPub = document.querySelector('#target li.checkable.rwa');
		var targets = document.querySelectorAll('#target li.target a');
		for (var i = 0; i < targets.length; i++) {
			targets[i].addEventListener('click', function (e) {
				e.preventDefault();
				var targetName = this.href.substring(this.href.indexOf('#') + 1);
				H.set(postTargetKey, targetName);

				try {
					document.querySelector('#target li.target.selected').classList.remove('selected');
				} catch (e) { }
				this.parentElement.classList.add('selected');
				var newText = this.innerText.split(' ');
				newText.shift();
				document.getElementById('target-name').innerText = newText.join(' ');

				$rwaPub.style.display = (targetName == 'anonymous' ? 'block' : 'none');
				if (document.querySelectorAll('#target li.integration').length == 0) {
					$rwaPub.previousElementSibling.style.display = (targetName == 'anonymous' ? 'block' : 'none');
				}
			});
		}
		var postTarget = H.get(postTargetKey, 'anonymous');
		if (location.hash != '') {
			postTarget = location.hash.substring(1);

			location.hash = '';
		}
		var pte = document.querySelector('#target li.target#blog-' + postTarget + ' a');
		if (pte != null) {
			pte.click();
		} else {
			postTarget = 'anonymous';
			H.set(postTargetKey, postTarget);
		}

		var sansLoaded = false;
		WebFontConfig = {
			custom: { families: ['Lora:400,700:latin'], urls: ['https:\/\/cdn.writeas.net/css/fonts.4ce1882.css'] }
		};
		var loadSans = function () {
			if (sansLoaded) return;
			sansLoaded = true;
			WebFontConfig.custom.families.push('Open+Sans:400,700:latin');
			try {
				(function () {
					var wf = document.createElement('script');
					wf.src = 'https:\/\/cdn.writeas.net/js/webfont.js';
					wf.type = 'text/javascript';
					wf.async = 'true';
					var s = document.getElementsByTagName('script')[0];
					s.parentNode.insertBefore(wf, s);
				})();
			} catch (e) { }
		};
		var fonts = document.querySelectorAll('nav#font-picker a.font');
		for (var i = 0; i < fonts.length; i++) {
			fonts[i].addEventListener('click', function (e) {
				e.preventDefault();
				selectedFont = this.href.substring(this.href.indexOf('#') + 1);
				$writer.el.className = selectedFont;
				document.querySelector('nav#font-picker li.selected').classList.remove('selected');
				this.parentElement.classList.add('selected');
				H.set('padFont', selectedFont);
				if (selectedFont == 'sans') {
					loadSans();
				}
				try {
					_paq.push(['trackEvent', 'Pad', 'change font', selectedFont]);
				} catch (e) { }
			});
		}
		var selectedFont = H.get('padFont', 'norm');
		var sfe = document.querySelector('nav#font-picker a.font.' + selectedFont);
		if (sfe != null) {
			sfe.click();
		}

		var removeXPost = function (xpostTarg, integID, integUsername) {
			for (var i = 0; i < xpostTarg.length; i++) {
				var key = Object.keys(xpostTarg[i])[0];
				if (key == integID && xpostTarg[i][key] == integUsername) {
					xpostTarg.splice(i, 1);
				}
			}
			return xpostTarg;
		};
		var integrations = document.querySelectorAll('#target li.integration a');
		for (var i = 0; i < integrations.length; i++) {
			integrations[i].addEventListener('click', function (e) {
				e.preventDefault();
				var integTarget = this.href.substring(this.href.indexOf('#') + 1);
				var integrationData = integTarget.split('/');
				var integID = integrationData[0];
				var integUsername = integrationData[1];

				var cb = this.querySelector('input');
				if (cb == null) {
					var $ex = document.getElementById('integration-upgrade');
					if ($ex != null) {

						$ex.parentNode.removeChild($ex);
					}
					var $upLI = document.createElement('li');
					$upLI.className = 'integration';
					$upLI.id = 'integration-upgrade';
					var $up = document.createElement('a');
					$up.innerText = "Upgrade to cross-post...";
					$up.href = "/me/plan?to=/&why=xpost";
					$up.className = 'upgrade-prompt';
					try {
						$up.onclick = _paq.push(['trackEvent', 'Subscription', 'prompt', 'pad channel select']);
					} catch (e) { }
					$upLI.appendChild($up);
					this.parentNode.parentNode.insertBefore($upLI, this.parentNode.nextSibling);
					return;
				}
				var xpostTarg = JSON.parse(H.get('crosspostTarget', '[]'));
				if (cb.checked) {

					xpostTarg = removeXPost(xpostTarg, integID, integUsername);
				} else {
					var newXP = {};
					newXP[integID] = integUsername;
					xpostTarg.push(newXP);
				}
				cb.checked = !cb.checked;
				H.set('crosspostTarget', JSON.stringify(xpostTarg));
			});
		}
		var getXPost = function () {
			var xpostTarg = JSON.parse(H.get('crosspostTarget', '[]'));
			for (var i = 0; i < xpostTarg.length; i++) {
				var key = Object.keys(xpostTarg[i])[0];
				var cb = document.querySelector('li.integration a[href=\'#' + key + '/' + xpostTarg[i][key] + '\'] input');
				if (cb == null) {
					xpostTarg = removeXPost(xpostTarg, key, xpostTarg[i][key]);
					H.set('crosspostTarget', JSON.stringify(xpostTarg));
					return;
				}
				cb.checked = true;
			}
		};
		getXPost();

		if ($rwaPub != null) {
			$rwaPub.querySelector('input').checked = false;
			$rwaPub.querySelector('a').addEventListener('click', function (e) {
				e.preventDefault();
				var hasSeenRWA = H.get('seenRWAModal', '0');
				if (hasSeenRWA == '0') {
					showModal('rwa');
					H.set('seenRWAModal', '1');
				}

				var cb = this.querySelector('input');
				cb.checked = !cb.checked;
				isPublic = cb.checked;
				_paq.push(['trackEvent', 'Pad', 'toggle read.write.as', isPublic ? 'on' : 'off']);
			});
		}


		H.getEl('switch-rich').on('click', function (e) {
			e.preventDefault();
			document.getElementById('classic-demo').src = 'https://i.snap.as/HrA976o2.png';
			showModal('editor-upgrade');
		});


		var doneTyping = function () {
			if (draftDoc == 'lastDoc' || $writer.el.value != origDoc) {
				H.save($writer, draftDoc);
				if (!defaultTimeSet) {
					var lastLocalPublishStr = localStorage.getItem(draftDoc + '-published');
					if (lastLocalPublishStr == null || lastLocalPublishStr == '') {
						localStorage.setItem(draftDoc + '-published', updatedStr);
					}
					defaultTimeSet = true;
				}
				updateWordCount();
			}
		};
		window.addEventListener('beforeunload', function (e) {
			if (draftDoc != 'lastDoc' && $writer.el.value == origDoc) {
				H.remove(draftDoc);
				H.remove(draftDoc + '-published');
			} else if (!justPublished) {
				doneTyping();
			}
		});

		try {
			(function () {
				var wf = document.createElement('script');
				wf.src = 'https:\/\/cdn.writeas.net/js/webfont.js';
				wf.type = 'text/javascript';
				wf.async = 'true';
				var s = document.getElementsByTagName('script')[0];
				s.parentNode.insertBefore(wf, s);
			})();
		} catch (e) {

		}

		try {
			var _paq = _paq || [];

			_paq.push(['trackPageView']);
			_paq.push(['enableLinkTracking']);
			_paq.push(['enableHeartBeatTimer']);
			(function () {
				var u = "https://analytics.write.as/";
				_paq.push(['setTrackerUrl', u + 'piwik.php']);
				_paq.push(['setSiteId', 1]);
				var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
				g.type = 'text/javascript'; g.async = true; g.defer = true; g.src = u + 'piwik.js'; s.parentNode.insertBefore(g, s);
			})();
		} catch (e) {

		}
	</script>
	<noscript>
		<p><img src="https://analytics.write.as/piwik.php?idsite=1" style="border:0;" alt="" /></p>
	</noscript>
	<link href="https://cdn.writeas.net/css/icons.66bfde6.css" rel="stylesheet">
</body>

</html>